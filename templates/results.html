<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>BuyBlack</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
        integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
        crossorigin="anonymous">
      <script async
    src={{url}}>
</script>
    <script type="text/javascript">
    var map;
    function initMap() {
       map =  new google.maps.Map(document.getElementById('map'), {
            center: {lat: {{latitude}}, lng:  {{longitude}}},
            zoom: 13
          }); 
        {% for business in businesses %}
            marker = new google.maps.Marker({
                position: {lat: {{business['geometry']['location']['lat']}}, lng:  {{business['geometry']['location']['lng']}}},
                map,
            });
            contentString = 
                '<div id="content">' +
                '<div id="siteNotice">' +
                "</div>" +
                '<h1 id="firstHeading" class="firstHeading">' + '{{business['name']}}' + '</h1>' +
                '<div id="bodyContent">' +
                "<p>" + '{{business['formatted_address']}}' +
                "</p>" +
                "</div>" +
                "</div>";

            var infowindow = new google.maps.InfoWindow({
                content: contentString,
            });
            marker.infowindow = infowindow;
            marker.addListener('mouseover', function() {
		        return this.infowindow.open(map, this);
	        });
            marker.addListener('mouseout', function() {
		        return this.infowindow.close(map, this);
	        });

        {% endfor %}
        
    }
    </script>
</head>
<body> 
    <div class="container">
        <h1>Welcome to Buy Black</h1>
        <h2>Find Other Black Owned businesses</h2>
        <h3>Black Owned: </h3>
        <form method="POST" action="/results">
            {{ form.option(class="form-control") }} 
            {{ form.submit(class="btn btn-primary") }}
        </form>
    </div>
    <div class="container">
        <h3>Black Owned {{choice}}</h3>
        <div id="map" style="width:100%; height:500px;"></div>
    </div>
    <div class="container">
        <h3>Results: </h3>
        {% for business in businesses %}
        <p>{{business['name']}}<br>
        {{business['formatted_address']}}</p>
        {% endfor %}
    </div>

</body>
</html>